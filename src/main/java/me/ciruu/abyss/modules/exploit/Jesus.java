package me.ciruu.abyss.modules.exploit;

import com.mojang.realmsclient.gui.ChatFormatting;
import java.util.function.Predicate;
import me.ciruu.abyss.Class202;
import me.ciruu.abyss.Class25;
import me.ciruu.abyss.Globals;
import me.ciruu.abyss.enums.Class11;
import me.ciruu.abyss.enums.Class53;
import me.ciruu.abyss.enums.Class586;
import me.ciruu.abyss.events.liquid.EventLiquidCollisionBB;
import me.ciruu.abyss.events.network.EventNetworkPostPacketEvent;
import me.ciruu.abyss.events.network.EventNetworkPrePacketEvent;
import me.ciruu.abyss.events.player.EventPlayerUpdate;
import me.ciruu.abyss.events.player.EventPlayerUpdateWalking;
import me.ciruu.abyss.modules.Module;
import me.ciruu.abyss.settings.Setting;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.block.Block;
import net.minecraft.block.BlockLiquid;
import net.minecraft.block.state.IBlockState;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraft.network.play.server.SPacketPlayerPosLook;
import net.minecraft.util.math.AxisAlignedBB;

public class Jesus
extends Module {
    private final Setting main = new Setting("Main", "", this, new Class25("Main Settings"));
    private final Setting mode = new Setting("Mode", "", this, (Object)Class586.Solid);
    private final Setting boost = new Setting("Boost", "", (Module)this, (Object)false, this.main, this::Method2924);
    private boolean Field2381 = false;
    private int Field2382 = 0;
    private int Field2383 = 0;
    private float Field2384;
    @EventHandler
    private Listener Field2385 = new Listener<EventPlayerUpdate>(this::Method2925, new Predicate[0]);
    @EventHandler
    private Listener Field2386 = new Listener<EventNetworkPrePacketEvent>(this::Method2926, new Predicate[0]);
    @EventHandler
    private Listener Field2387 = new Listener<EventPlayerUpdateWalking>(this::Method2927, new Predicate[0]);
    @EventHandler
    private Listener Field2388 = new Listener<EventNetworkPostPacketEvent>(this::Method2928, new Predicate[0]);
    @EventHandler
    private Listener Field2389 = new Listener<EventLiquidCollisionBB>(this::Method2929, new Predicate[0]);

    public Jesus() {
        super("Jesus", "Allows you to walk on water.", Class11.EXPLOIT);
        this.Method2930(this.mode);
    }

    public String Method2931() {
        return ChatFormatting.WHITE + ((Class586)((Object)this.mode.getValue())).name();
    }

    private boolean Method2932() {
        return Globals.mc.player.fallDistance < 3.0f && !Globals.mc.player.movementInput.jump && !Class202.Method940() && !Globals.mc.player.isSneaking();
    }

    private void Method2929(EventLiquidCollisionBB eventLiquidCollisionBB) {
        if (Globals.mc.world == null || Globals.mc.player == null) {
            return;
        }
        if (this.mode.getValue() == Class586.Dolphin) {
            return;
        }
        if (this.mode.getValue() == Class586.Solid && !Class202.Method941()) {
            return;
        }
        if (Class202.Method940()) {
            return;
        }
        IBlockState iBlockState = Globals.mc.world.getBlockState(eventLiquidCollisionBB.Method2133());
        if (iBlockState.getBlock() instanceof BlockLiquid && !Globals.mc.player.isRowingBoat()) {
            eventLiquidCollisionBB.cancel();
            eventLiquidCollisionBB.Method2135(Block.FULL_BLOCK_AABB);
            if (Globals.mc.player.getRidingEntity() != null) {
                eventLiquidCollisionBB.Method2135(new AxisAlignedBB(0.0, 0.0, 0.0, 1.0, (double)0.95f, 1.0));
            } else if (this.mode.getValue() == Class586.Dolphin && this.Method2932()) {
                eventLiquidCollisionBB.Method2135(new AxisAlignedBB((double)eventLiquidCollisionBB.Method2133().getX(), (double)eventLiquidCollisionBB.Method2133().getY(), (double)eventLiquidCollisionBB.Method2133().getY(), (double)eventLiquidCollisionBB.Method2133().getX(), (double)eventLiquidCollisionBB.Method2133().getY() + (Globals.mc.player.movementInput.jump ? 0.95 : 0.99), (double)eventLiquidCollisionBB.Method2133().getZ()));
            }
        }
    }

    private void Method2928(EventNetworkPostPacketEvent eventNetworkPostPacketEvent) {
        try {
            if (this.mode.getValue() != Class586.Solid || Globals.mc.world == null || Globals.mc.player == null && !Globals.mc.player.isRowingBoat()) {
                return;
            }
            if (eventNetworkPostPacketEvent.Method16() instanceof CPacketPlayer) {
                CPacketPlayer cPacketPlayer = (CPacketPlayer)eventNetworkPostPacketEvent.Method16();
                if (Class202.Method941() && this.Method2932()) {
                    cPacketPlayer.onGround = false;
                    cPacketPlayer.y = Globals.mc.player.ticksExisted % 2 == 0 ? cPacketPlayer.y - 0.05 : cPacketPlayer.y;
                }
            }
        }
        catch (Exception exception) {
            // empty catch block
        }
    }

    private void Method2927(EventPlayerUpdateWalking eventPlayerUpdateWalking) {
        if (eventPlayerUpdateWalking.Method100() != Class53.PRE) {
            return;
        }
        if (this.mode.getValue() == Class586.Solid && Globals.mc.player.isRowingBoat()) {
            return;
        }
    }

    private void Method2926(EventNetworkPrePacketEvent eventNetworkPrePacketEvent) {
        if (eventNetworkPrePacketEvent.Method49() instanceof SPacketPlayerPosLook) {
            this.Field2383 = 0;
        }
    }

    private void Method2925(EventPlayerUpdate eventPlayerUpdate) {
        if (this.mode.getValue() == Class586.Dolphin) {
            if (!Globals.mc.player.movementInput.sneak && !Globals.mc.player.movementInput.jump && Class202.Method940()) {
                Globals.mc.player.motionY = 0.131f;
            }
        } else if (this.mode.getValue() == Class586.Solid) {
            if (!Globals.mc.player.movementInput.sneak && !Globals.mc.player.movementInput.jump && Class202.Method940()) {
                Globals.mc.player.motionY = 0.1;
            }
            if (Class202.Method941() && this.Method2932() && ((Boolean)this.boost.getValue()).booleanValue()) {
                switch (this.Field2383) {
                    case 0: {
                        Globals.mc.player.motionX *= 1.1;
                        Globals.mc.player.motionZ *= 1.1;
                        break;
                    }
                    case 1: {
                        Globals.mc.player.motionX *= 1.27;
                        Globals.mc.player.motionZ *= 1.27;
                        break;
                    }
                    case 2: {
                        Globals.mc.player.motionX *= 1.51;
                        Globals.mc.player.motionZ *= 1.51;
                        break;
                    }
                    case 3: {
                        Globals.mc.player.motionX *= 1.15;
                        Globals.mc.player.motionZ *= 1.15;
                        break;
                    }
                    case 4: {
                        Globals.mc.player.motionX *= 1.23;
                        Globals.mc.player.motionZ *= 1.23;
                    }
                }
                ++this.Field2383;
                if (this.Field2383 > 4) {
                    this.Field2383 = 0;
                }
            }
        }
    }

    private boolean Method2924() {
        return this.mode.getValue() == Class586.Solid;
    }
}

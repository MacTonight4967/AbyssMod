package me.ciruu.abyss.modules.exploit;

import java.util.function.Predicate;
import me.ciruu.abyss.Globals;
import me.ciruu.abyss.enums.Class11;
import me.ciruu.abyss.modules.Module;
import me.ciruu.abyss.settings.Setting;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.entity.Entity;
import net.minecraft.entity.EntityLivingBase;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.CPacketEntityAction;
import net.minecraftforge.event.entity.player.AttackEntityEvent;

public class SuperKnockback
extends Module {
    private final Setting hurtTime = new Setting("hurtTime", "", (Module)this, (Object)10, 0, 10);
    private final Setting autoDisable = new Setting("AutoDisable", "", this, true);
    @EventHandler
    private Listener Field1517 = new Listener<AttackEntityEvent>(this::Method1927, new Predicate[0]);

    public SuperKnockback() {
        super("SuperKnockback", "", Class11.EXPLOIT);
        this.Method1928(this.hurtTime);
        this.Method1928(this.autoDisable);
    }

    private void Method1927(AttackEntityEvent attackEntityEvent) {
        if (attackEntityEvent.getTarget() instanceof EntityLivingBase) {
            if (((EntityLivingBase)attackEntityEvent.getTarget()).hurtTime > (Integer)this.hurtTime.getValue()) {
                return;
            }
            if (Globals.mc.player.isSprinting()) {
                Globals.mc.player.connection.sendPacket((Packet)new CPacketEntityAction((Entity)Globals.mc.player, CPacketEntityAction.Action.STOP_SPRINTING));
            }
            Globals.mc.player.connection.sendPacket((Packet)new CPacketEntityAction((Entity)Globals.mc.player, CPacketEntityAction.Action.START_SPRINTING));
            Globals.mc.player.connection.sendPacket((Packet)new CPacketEntityAction((Entity)Globals.mc.player, CPacketEntityAction.Action.STOP_SPRINTING));
            Globals.mc.player.connection.sendPacket((Packet)new CPacketEntityAction((Entity)Globals.mc.player, CPacketEntityAction.Action.START_SPRINTING));
            Globals.mc.player.setSprinting(true);
            Globals.mc.player.serverSprintState = true;
            if (((Boolean)this.autoDisable.getValue()).booleanValue()) {
                this.Method1929();
            }
        }
    }
}

package me.ciruu.abyss.modules.exploit;

import java.util.function.Predicate;
import me.ciruu.abyss.Globals;
import me.ciruu.abyss.Manager;
import me.ciruu.abyss.enums.Class11;
import me.ciruu.abyss.events.network.EventNetworkPostPacketEvent;
import me.ciruu.abyss.modules.Module;
import me.ciruu.abyss.modules.exploit.AutoMountDupe;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.entity.passive.AbstractChestHorse;
import net.minecraft.network.play.client.CPacketUseEntity;
import net.minecraft.world.World;

public class MountBypass
extends Module {
    private boolean Field366;
    @EventHandler
    private final Listener Field367 = new Listener<EventNetworkPostPacketEvent>(this::Method458, new Predicate[0]);

    public MountBypass() {
        super("MountBypass", "", Class11.EXPLOIT);
    }

    private boolean Method459() {
        if (Manager.moduleManager.isModuleEnabled(AutoMountDupe.class)) {
            return !((AutoMountDupe)Manager.moduleManager.getModuleByClass(AutoMountDupe.class)).Method460();
        }
        return true;
    }

    private void Method458(EventNetworkPostPacketEvent eventNetworkPostPacketEvent) {
        CPacketUseEntity cPacketUseEntity;
        if (eventNetworkPostPacketEvent.Method16() instanceof CPacketUseEntity && this.Method459() && (cPacketUseEntity = (CPacketUseEntity)eventNetworkPostPacketEvent.Method16()).getEntityFromWorld((World)Globals.mc.world) instanceof AbstractChestHorse && cPacketUseEntity.getAction() == CPacketUseEntity.Action.INTERACT_AT) {
            eventNetworkPostPacketEvent.cancel();
        }
    }
}
